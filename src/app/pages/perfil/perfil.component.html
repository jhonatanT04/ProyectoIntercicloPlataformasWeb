<div class="container">
  <div class="hader-main">
    <h2 (click)=" this.router.navigate([''])">
      <img src="logoPK.png" alt="logo">
      Parqueadero UPS

    </h2>
    <p (click)="cerrarSeccion()">
      <svg class="icon-perfil" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"
        fill="#FFFFFF">
        <path
          d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z" />
      </svg>
      Cerrar sesion
    </p>
  </div>
  <div class="container-cuerpo">
    <div class="card-client">
      <div class="datos">
        <h3>Mis Datos</h3>
        <svg class="icon-perfil" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"
          fill="#FFFFFF">
          <path
            d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z" />
        </svg>
        <h2>{{nombre}} {{apellido}}</h2>
        <p class="cliente">
          <span>Correo Electronico: {{correo}}</span>
          <span>Telefono: {{telefono}}</span>
        </p>
        <div class="botns">
          <button (click)="ActualizarPerfil = true">Actualizar Perfil</button>
        </div>
      </div>
    </div>
    <div class="contratos-container">
      <table border="1">
        <thead>
          <tr *ngIf="contratos.length !== 0">
            <th>Nombre del Espacio</th>
            <th>Placa</th>
            <th>Fecha de inicio</th>
            <th>Fecha de fin</th>
            <th>Tarifa</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let contrato of contratos">
            <td>{{ contrato.espacio.nombreEspacio }}</td>
            <td>{{ contrato.placa }}</td>
            <td>{{ contrato.fechaInicio }}</td>
            <td>{{ contrato.fechaFin }}</td>
            <td>{{ contrato.tarifa.costo }}</td>
          </tr>
          <tr *ngIf="contratos.length === 0">
            <td>No tienes contratos registrados.</td>
          </tr>
        </tbody>
      </table>

    </div>
    <div class="ticket-container">
      <table>
        <thead>
          <tr *ngIf="listTicktes.length !== 0">
            <th>Numero de Ticket</th>
            <th>Nombre del Espacio</th>
            <th>Placa</th>
            <th>Fecha de Ingreso</th>
            <th>Fecha de Salida</th>
            <th>Valor</th>
            
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let ticket of listTicktes">
            <td>{{ ticket.id }}</td>
            <td>{{ ticket.espacio.nombreEspacio }}</td>
            <td>{{ ticket.placa }}</td>
            <td>{{ ticket.fechaIngreso }}</td>
            <td>{{ ticket.fechaSalida ? ticket.fechaSalida : "---------" }}</td>
            <td>{{ ticket.valorTotal ? ticket.valorTotal : "Pendiente" }}</td>
          </tr>
          <tr *ngIf="listTicktes.length === 0">
            <td>No tienes tickets registrados.</td>
          </tr>
        </tbody>
      </table>
      <button class="btn-newTicket" (click)="abrirNewTicket()">
        Nuevo ticket
      </button>
    </div>
  </div>
  <div class="container-newTicket" *ngIf="newTickt">
    <div class="target-container-newTicket">
      <h3 *ngIf="newTickt&&!selectHoraIngreso">Seleccione un espacio</h3>
      <p *ngIf="newTickt&&!selectHoraIngreso">Para continuar</p>
      <button (click)="abrirNewTicket()" class="btn-exit-ticket">
        <svg class="close-icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0,0,256,256">
          <g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(8.53333,8.53333)"><path d="M7,4c-0.25587,0 -0.51203,0.09747 -0.70703,0.29297l-2,2c-0.391,0.391 -0.391,1.02406 0,1.41406l7.29297,7.29297l-7.29297,7.29297c-0.391,0.391 -0.391,1.02406 0,1.41406l2,2c0.391,0.391 1.02406,0.391 1.41406,0l7.29297,-7.29297l7.29297,7.29297c0.39,0.391 1.02406,0.391 1.41406,0l2,-2c0.391,-0.391 0.391,-1.02406 0,-1.41406l-7.29297,-7.29297l7.29297,-7.29297c0.391,-0.39 0.391,-1.02406 0,-1.41406l-2,-2c-0.391,-0.391 -1.02406,-0.391 -1.41406,0l-7.29297,7.29297l-7.29297,-7.29297c-0.1955,-0.1955 -0.45116,-0.29297 -0.70703,-0.29297z"></path></g></g>
          </svg>
      </button>
      
      <div class="espacios-grid" *ngIf="newTickt&&!selectHoraIngreso">
        <div *ngFor="let espacio of espacios; let i = index">
          <div class="espacio-card" *ngIf="espacio.estado!=='D'"[ngClass]="{'reservado': espacio.estado === 'R', 'ocupado': espacio.estado === 'O'}">
            <div class="espacio-info" >
              <h4>{{ espacio.nombreEspacio.length > 6 ? 'E' + (i + 1) : espacio.nombreEspacio.charAt(0) }}</h4>
            </div>
          </div>
          <div class="espacio-card" (click)="selecionarEspacio(espacio)" *ngIf="espacio.estado==='D' " [ngClass]="{'disponible': espacio.estado === 'D'} " [class.select]="espacio === espacioSeleccionado">
            <div class="espacio-info" >
              <h4>{{ espacio.nombreEspacio.length > 6 ? 'E' + (i + 1) : espacio.nombreEspacio }}</h4>
            </div>
          </div>
        </div>
      </div>
      <div>
        <button class="next-ticket-select" *ngIf="selectEspacio&&!selectHoraIngreso" (click)="selectHoraTicket()" >
          Continuara
        </button>
        <button class="next-ticket-notSelect" *ngIf="!selectEspacio&&!selectHoraIngreso">
          Continuar
        </button>
      </div>
      <div class="container-time" *ngIf="selectHoraIngreso">

        <h2>Ingrese la informacion del Tiket</h2>
        <div class="espacio-seleccionado">
          <div class="espacio-info" >
            <h4>{{espacioSeleccionado?.nombreEspacio }}</h4>
          </div>
        </div>
        <p>Ingrese la hora de ingreso</p>
        <input class="input-clock" type="time" [(ngModel)]="horaIngreso" name="horaIngreso" id="horaIngreso" [class.input-error]="!validarHoraIngreso()&&this.horaIngreso !== ''" required>   
        <p *ngIf="!validarHoraIngreso()&&this.horaIngreso !== ''" class="error-message">Hora incorrecta, Hora de apertura {{horarioDia?.horaApertura}} ,Hora de cerrar {{horarioDia?.horaCierre}}</p>
        <p>Ingrese la Placa del vehiculo</p>
        <input class="input-placa" type="text" [(ngModel)]="placa" name="horaIngreso" id="horaIngreso" placeholder="eje. ANI-1234" required [class.input-error]="!verificarPlaca()&&placa!==''"> 
        <p *ngIf="!verificarPlaca()&&placa!==''" class="error-message">Ingrese correctamente la placa</p> 
        <button class="crear-ticket valido" (click)="crearTicket()" *ngIf="selectHoraIngreso && validarHoraIngreso() &&verificarPlaca()" >Crear ticket</button>
        <button class="crear-ticket invalido" *ngIf="selectHoraIngreso && (!validarHoraIngreso() || !verificarPlaca())">Crear ticket</button>
      </div>
    </div>
  </div>
  <div *ngIf="ActualizarPerfil" class="modal">
    <div class="contenido-modal">
      <span class="close" (click)="actualizar(false)">&times;</span>
      <app-actualizar-perfil (actualizado)="actualizar($event)"></app-actualizar-perfil>
    </div>
  </div>
</div>

<div class="alert-container">
  <div *ngIf="showConfirmAlert" class="alert-conf">
    <svg class="icon" xmlns="http://www.w3.org/2000/svg" margin-right="10" width="25" height="25" fill="currentColor"
      class="bi bi-check-lg" viewBox="0 0 16 16">
      <path
        d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z" />
    </svg>
    {{textConfirm}}
  </div>
  <div class="alert-container" *ngIf="showDangerAlert">
      <div *ngIf="showDangerAlert" class="alert-danger">
        <svg viewBox="0 0 24 24" class="icon">
          <path fill="currentColor"
            d="M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z" />
        </svg>
        {{textError}}
      </div>
    </div>



